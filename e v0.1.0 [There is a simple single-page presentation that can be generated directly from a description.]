[33mtag v0.1.0[m
Tagger: sww <1248002362%40qq.com>
Date:   Fri Nov 14 06:25:02 2025 +0800

Release v0.1.0: [There is a simple single-page presentation that can be generated directly from a description.]

[33mcommit 8a40b03cdf3414d41756d4677d3cf53db5e5d02f[m[33m ([m[1;36mHEAD -> [m[1;32mdevelop[m[33m, [m[1;33mtag: v0.1.0[m[33m, [m[1;31morigin/develop[m[33m)[m
Author: sww <1248002362%40qq.com>
Date:   Fri Nov 14 03:29:26 2025 +0800

    Update calls to deepseek

[1mdiff --git a/mvp_fastapi/ENV_SETUP.md b/mvp_fastapi/ENV_SETUP.md[m
[1mnew file mode 100644[m
[1mindex 0000000..b57240a[m
[1m--- /dev/null[m
[1m+++ b/mvp_fastapi/ENV_SETUP.md[m
[36m@@ -0,0 +1,55 @@[m
[32m+[m[32m# ç¯å¢ƒå˜é‡è®¾ç½®æŒ‡å—[m
[32m+[m
[32m+[m[32m## å¿…éœ€çš„ç¯å¢ƒå˜é‡[m
[32m+[m
[32m+[m[32m### 1. DeepSeek API Key[m
[32m+[m[32m```bash[m
[32m+[m[32m# åœ¨ .env æ–‡ä»¶ä¸­è®¾ç½®[m
[32m+[m[32mDEEPSEEK_API_KEY=your_deepseek_api_key_here[m
[32m+[m
[32m+[m[32m# æˆ–è€…åœ¨å‘½ä»¤è¡Œä¸­è®¾ç½®[m
[32m+[m[32mexport DEEPSEEK_API_KEY="your_deepseek_api_key_here"[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 2. è·å– DeepSeek API Key[m
[32m+[m[32m1. è®¿é—® [DeepSeek å¼€æ”¾å¹³å°](https://platform.deepseek.com/)[m
[32m+[m[32m2. æ³¨å†Œè´¦å·å¹¶ç™»å½•[m
[32m+[m[32m3. åœ¨æ§åˆ¶å°ä¸­åˆ›å»º API Key[m
[32m+[m[32m4. å°† API Key å¡«å…¥ `.env` æ–‡ä»¶[m
[32m+[m
[32m+[m[32m## å¯é€‰çš„ç¯å¢ƒå˜é‡[m
[32m+[m
[32m+[m[32m### æ¨¡æ¿è·¯å¾„é…ç½®[m
[32m+[m[32m```bash[m
[32m+[m[32m# è‡ªå®šä¹‰æ¨¡æ¿æ–‡ä»¶è·¯å¾„[m
[32m+[m[32mTEMPLATE_PATH=templates/business_report.pptx[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m## ä½¿ç”¨æ–¹æ³•[m
[32m+[m
[32m+[m[32m### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ .env æ–‡ä»¶ï¼ˆæ¨èï¼‰[m
[32m+[m[32m1. å¤åˆ¶ `.env` æ–‡ä»¶[m
[32m+[m[32m2. å°† `your_deepseek_api_key_here` æ›¿æ¢ä¸ºçœŸå®çš„ API Key[m
[32m+[m[32m3. è¿è¡Œåº”ç”¨æ—¶ä¼šè‡ªåŠ¨åŠ è½½ç¯å¢ƒå˜é‡[m
[32m+[m
[32m+[m[32m### æ–¹æ³•äºŒï¼šå‘½ä»¤è¡Œè®¾ç½®[m
[32m+[m[32m```bash[m
[32m+[m[32m# Windows (PowerShell)[m
[32m+[m[32m$env:DEEPSEEK_API_KEY="your_api_key_here"[m
[32m+[m
[32m+[m[32m# Windows (CMD)[m
[32m+[m[32mset DEEPSEEK_API_KEY=your_api_key_here[m
[32m+[m
[32m+[m[32m# Linux/Mac[m
[32m+[m[32mexport DEEPSEEK_API_KEY="your_api_key_here"[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m## éªŒè¯è®¾ç½®[m
[32m+[m
[32m+[m[32mè¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯ç¯å¢ƒå˜é‡æ˜¯å¦è®¾ç½®æ­£ç¡®ï¼š[m
[32m+[m[32m```bash[m
[32m+[m[32mcd mvp_fastapi[m
[32m+[m[32mpython -c "import os; print('DEEPSEEK_API_KEY:', os.environ.get('DEEPSEEK_API_KEY', 'æœªè®¾ç½®'))"[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32må¦‚æœæ˜¾ç¤º API Keyï¼Œè¯´æ˜è®¾ç½®æˆåŠŸã€‚[m
\ No newline at end of file[m
[1mdiff --git a/mvp_fastapi/PPT_OPERATION_GUIDE.md b/mvp_fastapi/PPT_OPERATION_GUIDE.md[m
[1mnew file mode 100644[m
[1mindex 0000000..11ab2be[m
[1m--- /dev/null[m
[1m+++ b/mvp_fastapi/PPT_OPERATION_GUIDE.md[m
[36m@@ -0,0 +1,193 @@[m
[32m+[m[32m# PPTæ“ä½œæŒ‡å—[m
[32m+[m
[32m+[m[32m## PPTç»“æ„æ¦‚è¿°[m
[32m+[m
[32m+[m[32m### 1. Presentationï¼ˆæ¼”ç¤ºæ–‡ç¨¿ï¼‰[m
[32m+[m[32m- é¡¶å±‚å¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰å¹»ç¯ç‰‡å’Œæ¯ç‰ˆ[m
[32m+[m[32m- é€šè¿‡ `Presentation()` åˆ›å»ºæ–°PPT[m
[32m+[m[32m- é€šè¿‡ `Presentation(template_path)` åŠ è½½æ¨¡æ¿[m
[32m+[m
[32m+[m[32m### 2. Slideï¼ˆå¹»ç¯ç‰‡ï¼‰[m
[32m+[m[32m- æ¼”ç¤ºæ–‡ç¨¿ä¸­çš„å•é¡µ[m
[32m+[m[32m- é€šè¿‡ `slides.add_slide(layout)` æ·»åŠ [m
[32m+[m[32m- é€šè¿‡ `slides[index]` è®¿é—®ç‰¹å®šå¹»ç¯ç‰‡[m
[32m+[m
[32m+[m[32m### 3. Slide Layoutï¼ˆå¹»ç¯ç‰‡å¸ƒå±€ï¼‰[m
[32m+[m[32m- é¢„å®šä¹‰çš„å¹»ç¯ç‰‡æ¨¡æ¿[m
[32m+[m[32m- é€šè¿‡ `slide_layouts[index]` è®¿é—®[m
[32m+[m[32m- å¸¸è§å¸ƒå±€ï¼š[m
[32m+[m[32m  - 0: æ ‡é¢˜å¹»ç¯ç‰‡[m
[32m+[m[32m  - 1: æ ‡é¢˜å’Œå†…å®¹[m
[32m+[m[32m  - 2: èŠ‚æ ‡é¢˜[m
[32m+[m[32m  - 3: ä¸¤æ å†…å®¹[m
[32m+[m[32m  - 4: æ¯”è¾ƒ[m
[32m+[m[32m  - 5: ä»…æ ‡é¢˜[m
[32m+[m[32m  - 6: ç©ºç™½[m
[32m+[m
[32m+[m[32m### 4. Shapeï¼ˆå½¢çŠ¶ï¼‰[m
[32m+[m[32m- å¹»ç¯ç‰‡ä¸Šçš„å…ƒç´ ï¼ˆæ–‡æœ¬æ¡†ã€å›¾ç‰‡ã€å›¾è¡¨ç­‰ï¼‰[m
[32m+[m[32m- é€šè¿‡ `shapes` é›†åˆè®¿é—®[m
[32m+[m[32m- `shapes.title`: æ ‡é¢˜å½¢çŠ¶[m
[32m+[m[32m- `placeholders`: å ä½ç¬¦å½¢çŠ¶[m
[32m+[m
[32m+[m[32m## åŸºæœ¬æ“ä½œ[m
[32m+[m
[32m+[m[32m### 1. åˆ›å»ºPPT[m
[32m+[m[32m```python[m
[32m+[m[32mfrom pptx import Presentation[m
[32m+[m
[32m+[m[32m# åˆ›å»ºç©ºç™½PPT[m
[32m+[m[32mprs = Presentation()[m
[32m+[m
[32m+[m[32m# ä»æ¨¡æ¿åˆ›å»º[m
[32m+[m[32mprs = Presentation("template.pptx")[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 2. æ·»åŠ å¹»ç¯ç‰‡[m
[32m+[m[32m```python[m
[32m+[m[32m# æ·»åŠ æ ‡é¢˜å¹»ç¯ç‰‡[m
[32m+[m[32mtitle_slide = prs.slides.add_slide(prs.slide_layouts[0])[m
[32m+[m
[32m+[m[32m# æ·»åŠ å†…å®¹å¹»ç¯ç‰‡[m
[32m+[m[32mcontent_slide = prs.slides.add_slide(prs.slide_layouts[1])[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 3. ä¿®æ”¹å†…å®¹[m
[32m+[m[32m```python[m
[32m+[m[32m# ä¿®æ”¹æ ‡é¢˜[m
[32m+[m[32mslide.shapes.title.text = "æ–°æ ‡é¢˜"[m
[32m+[m
[32m+[m[32m# ä¿®æ”¹å†…å®¹å ä½ç¬¦[m
[32m+[m[32mcontent = slide.placeholders[1][m
[32m+[m[32mcontent.text = "å†…å®¹æ–‡æœ¬"[m
[32m+[m
[32m+[m[32m# æ·»åŠ åˆ—è¡¨[m
[32m+[m[32mtext_frame = content.text_frame[m
[32m+[m[32mtext_frame.clear()[m
[32m+[m[32mp1 = text_frame.paragraphs[0][m
[32m+[m[32mp1.text = "â€¢ é¡¹ç›®1"[m
[32m+[m[32mp2 = text_frame.add_paragraph()[m
[32m+[m[32mp2.text = "â€¢ é¡¹ç›®2"[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 4. åˆ é™¤å¹»ç¯ç‰‡[m
[32m+[m[32m```python[m
[32m+[m[32m# åˆ é™¤ç‰¹å®šå¹»ç¯ç‰‡[m
[32m+[m[32mslide = prs.slides[0][m
[32m+[m[32mprs.slides._sldIdLst.remove(slide._element)[m
[32m+[m
[32m+[m[32m# æ¸…ç©ºæ‰€æœ‰å¹»ç¯ç‰‡[m
[32m+[m[32mfor i in range(len(prs.slides)-1, -1, -1):[m
[32m+[m[32m    rId = prs.slides._sldIdLst[i].rId[m
[32m+[m[32m    prs.part.drop_rel(rId)[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 5. å¤åˆ¶å¹»ç¯ç‰‡[m
[32m+[m[32m```python[m
[32m+[m[32m# å¤åˆ¶å¹»ç¯ç‰‡ï¼ˆå¤æ‚æ“ä½œï¼Œéœ€è¦å¤åˆ¶XMLï¼‰[m
[32m+[m[32mdef duplicate_slide(prs, index):[m
[32m+[m[32m    source = prs.slides[index][m
[32m+[m[32m    slide_layout = source.slide_layout[m
[32m+[m[41m    [m
[32m+[m[32m    # åˆ›å»ºæ–°å¹»ç¯ç‰‡[m
[32m+[m[32m    dest = prs.slides.add_slide(slide_layout)[m
[32m+[m[41m    [m
[32m+[m[32m    # å¤åˆ¶æ‰€æœ‰å½¢çŠ¶[m
[32m+[m[32m    for shape in source.shapes:[m
[32m+[m[32m        # è¿™é‡Œéœ€è¦å¤æ‚çš„XMLå¤åˆ¶é€»è¾‘[m
[32m+[m[32m        pass[m
[32m+[m[41m    [m
[32m+[m[32m    return dest[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m## æ¨¡æ¿å¼•æ“ä½¿ç”¨æ–¹æ³•[m
[32m+[m
[32m+[m[32m### 1. ç®€å•ä½¿ç”¨[m
[32m+[m[32m```python[m
[32m+[m[32mfrom services.design import TemplateEngine[m
[32m+[m
[32m+[m[32mengine = TemplateEngine()[m
[32m+[m[32mresult = engine.create_from_template(title="æˆ‘çš„æ¼”ç¤ºæ–‡ç¨¿")[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 2. è‡ªå®šä¹‰å¹»ç¯ç‰‡[m
[32m+[m[32m```python[m
[32m+[m[32mslides_data = [[m
[32m+[m[32m    {[m
[32m+[m[32m        'slide_type': 'title',[m
[32m+[m[32m        'title': 'é¡¹ç›®æ±‡æŠ¥'[m
[32m+[m[32m    },[m
[32m+[m[32m    {[m
[32m+[m[32m        'slide_type': 'content',[m
[32m+[m[32m        'title': 'é¡¹ç›®æ¦‚è¿°',[m
[32m+[m[32m        'content': ['é¡¹ç›®èƒŒæ™¯', 'é¡¹ç›®ç›®æ ‡', 'é¡¹ç›®èŒƒå›´'][m
[32m+[m[32m    },[m
[32m+[m[32m    {[m
[32m+[m[32m        'slide_type': 'two_column',[m
[32m+[m[32m        'title': 'è¿›åº¦å¯¹æ¯”',[m
[32m+[m[32m        'left_content': ['å·²å®Œæˆå·¥ä½œ1', 'å·²å®Œæˆå·¥ä½œ2'],[m
[32m+[m[32m        'right_content': ['å¾…å®Œæˆå·¥ä½œ1', 'å¾…å®Œæˆå·¥ä½œ2'][m
[32m+[m[32m    }[m
[32m+[m[32m][m
[32m+[m
[32m+[m[32mresult = engine.create_from_template(title="é¡¹ç›®æ±‡æŠ¥", slides_data=slides_data)[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 3. ä¿å­˜æ–‡ä»¶[m
[32m+[m[32m```python[m
[32m+[m[32m# ä¿å­˜åˆ°æ–‡ä»¶[m
[32m+[m[32mwith open("output.pptx", "wb") as f:[m
[32m+[m[32m    f.write(result['buffer'].getvalue())[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m## å¸¸ç”¨æ“ä½œç¤ºä¾‹[m
[32m+[m
[32m+[m[32m### æ·»åŠ å›¾ç‰‡[m
[32m+[m[32m```python[m
[32m+[m[32mfrom pptx.util import Inches[m
[32m+[m
[32m+[m[32mslide = prs.slides.add_slide(prs.slide_layouts[5])  # ä»…æ ‡é¢˜å¸ƒå±€[m
[32m+[m[32mleft = top = Inches(1)[m
[32m+[m[32mpic = slide.shapes.add_picture("image.jpg", left, top, width=Inches(5))[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### æ·»åŠ è¡¨æ ¼[m
[32m+[m[32m```python[m
[32m+[m[32mfrom pptx.util import Inches[m
[32m+[m
[32m+[m[32mrows = cols = 2[m
[32m+[m[32mleft = top = Inches(2.0)[m
[32m+[m[32mwidth = Inches(6.0)[m
[32m+[m[32mheight = Inches(0.8)[m
[32m+[m
[32m+[m[32mtable = slide.shapes.add_table(rows, cols, left, top, width, height).table[m
[32m+[m
[32m+[m[32m# è®¾ç½®è¡¨å¤´[m
[32m+[m[32mtable.cell(0, 0).text = 'å§“å'[m
[32m+[m[32mtable.cell(0, 1).text = 'åˆ†æ•°'[m
[32m+[m
[32m+[m[32m# è®¾ç½®æ•°æ®[m
[32m+[m[32mtable.cell(1, 0).text = 'å¼ ä¸‰'[m
[32m+[m[32mtable.cell(1, 1).text = '95'[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### æ·»åŠ å›¾è¡¨[m
[32m+[m[32m```python[m
[32m+[m[32mfrom pptx.chart.data import CategoryChartData[m
[32m+[m
[32m+[m[32mchart_data = CategoryChartData()[m
[32m+[m[32mchart_data.categories = ['Q1', 'Q2', 'Q3', 'Q4'][m
[32m+[m[32mchart_data.add_series('é”€å”®é¢', (19.2, 21.4, 16.7, 19.2))[m
[32m+[m
[32m+[m[32mx, y, cx, cy = Inches(2), Inches(2), Inches(6), Inches(4.5)[m
[32m+[m[32mslide.shapes.add_chart([m
[32m+[m[32m    XL_CHART_TYPE.COLUMN_CLUSTERED, x, y, cx, cy, chart_data[m
[32m+[m[32m)[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m## æ³¨æ„äº‹é¡¹[m
[32m+[m
[32m+[m[32m1. **å¸ƒå±€ç´¢å¼•**: ä¸åŒæ¨¡æ¿çš„å¸ƒå±€ç´¢å¼•å¯èƒ½ä¸åŒ[m
[32m+[m[32m2. **å ä½ç¬¦**: æ£€æŸ¥å ä½ç¬¦æ˜¯å¦å­˜åœ¨å†æ“ä½œ[m
[32m+[m[32m3. **æ–‡æœ¬æ ¼å¼**: ä½¿ç”¨ `text_frame` è¿›è¡Œå¤æ‚æ–‡æœ¬æ“ä½œ[m
[32m+[m[32m4. **ä¿å­˜**: ä½¿ç”¨ `prs.save("filename.pptx")` ä¿å­˜æ–‡ä»¶[m
\ No newline at end of file[m
[1mdiff --git a/mvp_fastapi/SIMPLE_USAGE.md b/mvp_fastapi/SIMPLE_USAGE.md[m
[1mnew file mode 100644[m
[1mindex 0000000..c038a3e[m
[1m--- /dev/null[m
[1m+++ b/mvp_fastapi/SIMPLE_USAGE.md[m
[36m@@ -0,0 +1,74 @@[m
[32m+[m[32m# æç®€PPTæ¨¡æ¿å¼•æ“ä½¿ç”¨è¯´æ˜[m
[32m+[m
[32m+[m[32m## æ¦‚è¿°[m
[32m+[m
[32m+[m[32mè¿™æ˜¯ä¸€ä¸ªæç®€çš„PPTæ¨¡æ¿å¼•æ“ï¼Œä½¿ç”¨æ‚¨ä¸‹è½½çš„Officeå®˜æ–¹æ¨¡æ¿æ–‡ä»¶ï¼Œè¿›è¡Œç®€å•ä¿®æ”¹åè°ƒç”¨ç°æœ‰çš„exporteræœåŠ¡å¯¼å‡ºPPTXæ–‡ä»¶ã€‚[m
[32m+[m
[32m+[m[32m## æ ¸å¿ƒåŠŸèƒ½[m
[32m+[m
[32m+[m[32m- **æ¨¡æ¿åŠ è½½**: è‡ªåŠ¨åŠ è½½ `templates/business_report.pptx` æ¨¡æ¿æ–‡ä»¶[m
[32m+[m[32m- **ç®€å•ä¿®æ”¹**: æ›´æ–°ç¬¬ä¸€å¼ å¹»ç¯ç‰‡çš„æ ‡é¢˜[m
[32m+[m[32m- **å¯¼å‡ºé›†æˆ**: ç›´æ¥ä½¿ç”¨ç°æœ‰çš„ `PPTExporter` æœåŠ¡å¯¼å‡º[m
[32m+[m
[32m+[m[32m## ä½¿ç”¨æ–¹æ³•[m
[32m+[m
[32m+[m[32m### 1. åŸºæœ¬ä½¿ç”¨[m
[32m+[m
[32m+[m[32m```python[m
[32m+[m[32mfrom services.design import TemplateEngine[m
[32m+[m
[32m+[m[32m# åˆ›å»ºæ¨¡æ¿å¼•æ“[m
[32m+[m[32mengine = TemplateEngine()[m
[32m+[m
[32m+[m[32m# æ–¹æ³•1: ç›´æ¥ä»æ¨¡æ¿åˆ›å»ºPPT[m
[32m+[m[32mresult = engine.create_from_template(title="æˆ‘çš„æ¼”ç¤ºæ–‡ç¨¿")[m
[32m+[m[32m# è¿”å›: {'buffer': BytesIO, 'content_type': '...', 'filename': '...', 'file_size': ...}[m
[32m+[m
[32m+[m[32m# æ–¹æ³•2: ä¿®æ”¹ç°æœ‰PPTå¹¶å¯¼å‡º[m
[32m+[m[32mfrom pptx import Presentation[m
[32m+[m[32mprs = Presentation()[m
[32m+[m[32m# ... æ·»åŠ å†…å®¹åˆ°prs[m
[32m+[m[32mresult = engine.modify_and_export(prs, title="æˆ‘çš„PPT")[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 2. æ–‡ä»¶ç»“æ„[m
[32m+[m
[32m+[m[32m```[m
[32m+[m[32mmvp_fastapi/[m
[32m+[m[32mâ”œâ”€â”€ templates/[m
[32m+[m[32mâ”‚   â””â”€â”€ business_report.pptx  # æ‚¨ä¸‹è½½çš„Officeæ¨¡æ¿[m
[32m+[m[32mâ”œâ”€â”€ services/[m
[32m+[m[32mâ”‚   â”œâ”€â”€ design.py            # æç®€æ¨¡æ¿å¼•æ“[m
[32m+[m[32mâ”‚   â””â”€â”€ exporter.py          # ç°æœ‰å¯¼å‡ºæœåŠ¡[m
[32m+[m[32mâ””â”€â”€ test_simple_design.py    # æµ‹è¯•è„šæœ¬[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 3. å·¥ä½œæµç¨‹[m
[32m+[m
[32m+[m[32m1. **åŠ è½½æ¨¡æ¿**: [`load_template()`](services/design.py:18) åŠ è½½æœ¬åœ°æ¨¡æ¿æ–‡ä»¶[m
[32m+[m[32m2. **ç®€å•ä¿®æ”¹**: æ›´æ–°ç¬¬ä¸€å¼ å¹»ç¯ç‰‡çš„æ ‡é¢˜[m
[32m+[m[32m3. **å¯¼å‡º**: è°ƒç”¨ [`PPTExporter.export_ppt()`](services/exporter.py:19) å¯¼å‡ºPPTX[m
[32m+[m
[32m+[m[32m## ç¤ºä¾‹ä»£ç [m
[32m+[m
[32m+[m[32m```python[m
[32m+[m[32m# åˆ›å»ºå¸¦æ¨¡æ¿æ ·å¼çš„PPT[m
[32m+[m[32mfrom services.design import TemplateEngine[m
[32m+[m
[32m+[m[32mengine = TemplateEngine()[m
[32m+[m
[32m+[m[32m# åˆ›å»ºå•†åŠ¡æŠ¥å‘Š[m
[32m+[m[32mresult = engine.create_from_template(title="2024å¹´åº¦æŠ¥å‘Š")[m
[32m+[m[32mprint(f"æ–‡ä»¶: {result['filename']}, å¤§å°: {result['file_size']} bytes")[m
[32m+[m
[32m+[m[32m# ä¿å­˜åˆ°æ–‡ä»¶[m
[32m+[m[32mwith open("output.pptx", "wb") as f:[m
[32m+[m[32m    f.write(result['buffer'].getvalue())[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m## æ³¨æ„äº‹é¡¹[m
[32m+[m
[32m+[m[32m- ç¡®ä¿æ¨¡æ¿æ–‡ä»¶ `templates/business_report.pptx` å­˜åœ¨[m
[32m+[m[32m- å¦‚æœæ¨¡æ¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¼šåˆ›å»ºç©ºç™½PPTä½œä¸ºå¤‡é€‰[m
[32m+[m[32m- å¯¼å‡ºæ ¼å¼å›ºå®šä¸ºPPTXï¼Œä½¿ç”¨ç°æœ‰exporteræœåŠ¡[m
[32m+[m[32m- ä¿®æ”¹åŠŸèƒ½ç®€å•ï¼Œåªæ›´æ–°ç¬¬ä¸€å¼ å¹»ç¯ç‰‡çš„æ ‡é¢˜[m
\ No newline at end of file[m
[1mdiff --git a/mvp_fastapi/TEMPLATE_USAGE.md b/mvp_fastapi/TEMPLATE_USAGE.md[m
[1mnew file mode 100644[m
[1mindex 0000000..9eceb47[m
[1m--- /dev/null[m
[1m+++ b/mvp_fastapi/TEMPLATE_USAGE.md[m
[36m@@ -0,0 +1,71 @@[m
[32m+[m[32m# PPTæ¨¡æ¿å¼•æ“ä½¿ç”¨è¯´æ˜[m
[32m+[m
[32m+[m[32m## æ¨¡æ¿é…ç½®[m
[32m+[m
[32m+[m[32må½“å‰ç³»ç»Ÿé…ç½®äº†ä¸€ä¸ªæ¨¡æ¿ï¼š**å•†åŠ¡æŠ¥å‘Šæ¨¡æ¿**[m
[32m+[m
[32m+[m[32m- **æ¨¡æ¿é”®å**: `business_report`[m
[32m+[m[32m- **æ¨¡æ¿æ–‡ä»¶**: `business_report.pptx`[m
[32m+[m[32m- **å­˜å‚¨ä½ç½®**: `mvp_fastapi/templates/business_report.pptx`[m
[32m+[m
[32m+[m[32m## ä½¿ç”¨æ­¥éª¤[m
[32m+[m
[32m+[m[32m### 1. ä¸‹è½½Officeå®˜æ–¹æ¨¡æ¿[m
[32m+[m
[32m+[m[32m1. è®¿é—® [Officeæ¨¡æ¿ç½‘ç«™](https://templates.office.com/)[m
[32m+[m[32m2. æœç´¢å¹¶ä¸‹è½½ä¸€ä¸ªå•†åŠ¡æŠ¥å‘Šæ¨¡æ¿ï¼ˆ.pptxæ ¼å¼ï¼‰[m
[32m+[m[32m3. å°†ä¸‹è½½çš„æ¨¡æ¿æ–‡ä»¶é‡å‘½åä¸º `business_report.pptx`[m
[32m+[m[32m4. å°†æ–‡ä»¶ä¿å­˜åˆ° `mvp_fastapi/templates/` ç›®å½•[m
[32m+[m
[32m+[m[32m### 2. ä½¿ç”¨æ¨¡æ¿å¼•æ“[m
[32m+[m
[32m+[m[32m```python[m
[32m+[m[32mfrom services.design import TemplateEngine[m
[32m+[m[32mfrom pptx import Presentation[m
[32m+[m
[32m+[m[32m# åˆ›å»ºæ¨¡æ¿å¼•æ“[m
[32m+[m[32mengine = TemplateEngine()[m
[32m+[m
[32m+[m[32m# è·å–å¯ç”¨æ¨¡æ¿[m
[32m+[m[32mtemplates = engine.get_available_templates()[m
[32m+[m[32mprint(templates)[m
[32m+[m
[32m+[m[32m# åˆ›å»ºå¸¦æ ·å¼çš„PPT[m
[32m+[m[32mresult = engine.create_styled_presentation([m
[32m+[m[32m    template_name="business_report",[m
[32m+[m[32m    slides_data=None  # å¯ä»¥ä¼ å…¥è‡ªå®šä¹‰å¹»ç¯ç‰‡æ•°æ®[m
[32m+[m[32m)[m
[32m+[m
[32m+[m[32m# å¯¼å‡ºå¸¦æ ·å¼çš„ç°æœ‰PPT[m
[32m+[m[32mprs = Presentation()  # æ‚¨çš„PPTå¯¹è±¡[m
[32m+[m[32mexport_result = engine.export_styled_ppt([m
[32m+[m[32m    presentation=prs,[m
[32m+[m[32m    template_name="business_report",[m
[32m+[m[32m    title="æˆ‘çš„æ¼”ç¤ºæ–‡ç¨¿"[m
[32m+[m[32m)[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m### 3. æ¨¡æ¿æ–‡ä»¶ç»“æ„[m
[32m+[m
[32m+[m[32m```[m
[32m+[m[32mmvp_fastapi/[m
[32m+[m[32mâ”œâ”€â”€ templates/[m
[32m+[m[32mâ”‚   â””â”€â”€ business_report.pptx  # æ‚¨ä¸‹è½½çš„Officeæ¨¡æ¿æ–‡ä»¶[m
[32m+[m[32mâ”œâ”€â”€ services/[m
[32m+[m[32mâ”‚   â””â”€â”€ design.py            # æ¨¡æ¿å¼•æ“å®ç°[m
[32m+[m[32mâ””â”€â”€ test_design.py           # æµ‹è¯•è„šæœ¬[m
[32m+[m[32m```[m
[32m+[m
[32m+[m[32m## åŠŸèƒ½ç‰¹ç‚¹[m
[32m+[m
[32m+[m[32m- âœ… ä½¿ç”¨çœŸå®çš„Officeå®˜æ–¹æ¨¡æ¿[m
[32m+[m[32m- âœ… ä¸ç°æœ‰exporteræœåŠ¡æ— ç¼é›†æˆ[m
[32m+[m[32m- âœ… è‡ªåŠ¨æ£€æµ‹æ¨¡æ¿æ–‡ä»¶å­˜åœ¨æ€§[m
[32m+[m[32m- âœ… æä¾›å¤‡é€‰åŸºç¡€æ ·å¼[m
[32m+[m[32m- âœ… æ”¯æŒæ¨¡æ¿æ ·å¼å¤åˆ¶[m
[32m+[m
[32m+[m[32m## æ³¨æ„äº‹é¡¹[m
[32m+[m
[32m+[m[32m- å¦‚æœæ¨¡æ¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºåŸºç¡€æ ·å¼ä½œä¸ºå¤‡é€‰[m
[32m+[m[32m- æ¨¡æ¿æ–‡ä»¶å¿…é¡»æ˜¯æœ‰æ•ˆçš„.pptxæ ¼å¼[m
[32m+[m[32m- ç³»ç»Ÿä¼šå¤åˆ¶æ¨¡æ¿çš„æ¯ç‰ˆæ ·å¼åˆ°ç›®æ ‡PPT[m
\ No newline at end of file[m
[1mdiff --git a/mvp_fastapi/main.py b/mvp_fastapi/main.py[m
[1mindex b44064c..7663c4e 100644[m
[1m--- a/mvp_fastapi/main.py[m
[1m+++ b/mvp_fastapi/main.py[m
[36m@@ -1 +1 @@[m
[31m-# FastAPIåº”ç”¨å…¥å£ç‚¹ï¼Œæä¾›PPTç”ŸæˆAPIå’ŒWebç•Œé¢[m
\ No newline at end of file[m
[32m+[m[32m# FastAPIåº”ç”¨å…¥å£ç‚¹ï¼Œæä¾›PPTç”ŸæˆAPIå’ŒWebç•Œé¢[m
[1mdiff --git a/mvp_fastapi/orchestrator.py b/mvp_fastapi/orchestrator.py[m
[1mindex 41880b3..29bcd90 100644[m
[1m--- a/mvp_fastapi/orchestrator.py[m
[1m+++ b/mvp_fastapi/orchestrator.py[m
[36m@@ -1 +1 @@[m
[31m-# æ ¸å¿ƒç¼–æ’å™¨ï¼Œåè°ƒå„ä¸ªæœåŠ¡æ¨¡å—å®ŒæˆPPTç”Ÿæˆæµç¨‹[m
\ No newline at end of file[m
[32m+[m[32m# æ ¸å¿ƒç¼–æ’å™¨ï¼Œåè°ƒå„ä¸ªæœåŠ¡æ¨¡å—å®ŒæˆPPTç”Ÿæˆæµç¨‹[m
[1mdiff --git a/mvp_fastapi/requirements.txt b/mvp_fastapi/requirements.txt[m
[1mindex 8b9da54..c7a8cd1 100644[m
[1m--- a/mvp_fastapi/requirements.txt[m
[1m+++ b/mvp_fastapi/requirements.txt[m
[36m@@ -1 +1,20 @@[m
[31m-# é¡¹ç›®ä¾èµ–åŒ…åˆ—è¡¨ï¼ŒåŒ…å«FastAPIã€python-pptxç­‰æ ¸å¿ƒåº“[m
\ No newline at end of file[m
[32m+[m[32m# Webæ¡†æ¶[m
[32m+[m[32mfastapi>=0.104.0[m
[32m+[m[32muvicorn[standard]>=0.24.0[m
[32m+[m
[32m+[m[32m# PPTå¤„ç†[m
[32m+[m[32mpython-pptx>=0.6.23[m
[32m+[m
[32m+[m[32m# æ¨¡æ¿å’Œæ¸²æŸ“[m
[32m+[m[32mjinja2>=3.1.0[m
[32m+[m[32mreportlab>=4.0.0[m
[32m+[m[32mpillow>=10.0.0[m
[32m+[m
[32m+[m[32m# LangChain å’Œ LLM é›†æˆ[m
[32m+[m[32mlangchain>=0.0.340[m
[32m+[m
[32m+[m[32m# ç¯å¢ƒå˜é‡ç®¡ç†[m
[32m+[m[32mpython-dotenv>=1.0.0[m
[32m+[m
[32m+[m[32m# å…¶ä»–å·¥å…·[m
[32m+[m[32mrequests>=2.31.0[m
\ No newline at end of file[m
[1mdiff --git a/mvp_fastapi/services/__init__.py b/mvp_fastapi/services/__init__.py[m
[1mindex ef5f1e4..1a779b8 100644[m
[1m--- a/mvp_fastapi/services/__init__.py[m
[1m+++ b/mvp_fastapi/services/__init__.py[m
[36m@@ -1 +1,5 @@[m
[31m-# æœåŠ¡æ¨¡å—åˆå§‹åŒ–æ–‡ä»¶ï¼Œå¯¼å‡ºæ‰€æœ‰æœåŠ¡åŠŸèƒ½[m
\ No newline at end of file[m
[32m+[m[32m# æœåŠ¡æ¨¡å—åˆå§‹åŒ–æ–‡ä»¶ï¼Œå¯¼å‡ºæ‰€æœ‰æœåŠ¡åŠŸèƒ½[m
[32m+[m
[32m+[m[32mfrom .exporter import PPTExporter, exporter_service[m
[32m+[m
[32m+[m[32m__all__ = ["PPTExporter", "exporter_service"][m
[1mdiff --git a/mvp_fastapi/services/content.py b/mvp_fastapi/services/content.py[m
[1mindex 39e09cc..93af549 100644[m
[1m--- a/mvp_fastapi/services/content.py[m
[1m+++ b/mvp_fastapi/services/content.py[m
[36m@@ -1 +1,230 @@[m
[31m-# å†…å®¹ç”ŸæˆæœåŠ¡ï¼Œæ ¹æ®å¤§çº²ç”Ÿæˆè¯¦ç»†çš„PPTå†…å®¹[m
\ No newline at end of file[m
[32m+[m[32m"""[m
[32m+[m[32må†…å®¹ç”ŸæˆæœåŠ¡ (content.py) - V1 æ¶æ„ä¿®å¤ç‰ˆ[m
[32m+[m
[32m+[m[32mæ­¤æ¨¡å—é‡‡ç”¨ V1 æ¶æ„ï¼ˆPython ç¼–æ’ï¼ŒLLM é€é¡µç”Ÿæˆï¼‰ï¼Œä»¥è§£å†³ V2 æ¶æ„çš„ Token é™åˆ¶[m
[32m+[m[32må’Œå†…å®¹ä¸å¯æ§é£é™©ã€‚[m
[32m+[m[32m"""[m
[32m+[m
[32m+[m[32mimport os[m
[32m+[m[32mimport logging[m
[32m+[m[32mimport io[m
[32m+[m[32mfrom typing import Dict, Any, List, Optional, Union[m
[32m+[m[32mfrom dotenv import load_dotenv[m
[32m+[m[32mfrom langchain_deepseek import ChatDeepSeek[m
[32m+[m[32mfrom langchain_core.prompts import ChatPromptTemplate[m
[32m+[m[32mfrom pydantic import BaseModel, Field, ValidationError[m
[32m+[m[32mfrom langchain_core.exceptions import OutputParserException[m
[32m+[m[32mfrom .design import TemplateEngine, PPTExporter[m
[32m+[m
[32m+[m[32m# --- æ—¥å¿—é…ç½® ---[m
[32m+[m[32mlogger = logging.getLogger(__name__)[m
[32m+[m
[32m+[m[32m# --- 1. LangChain Pydantic Schemas (V1 æ¶æ„) ---[m
[32m+[m[32m# V1 æ¶æ„ä¸‹ï¼Œæˆ‘ä»¬ä¸ºæ¯ç§å¹»ç¯ç‰‡ç±»å‹å®šä¹‰ä¸“é—¨çš„ Pydantic è¾“å‡ºæ¨¡å‹[m
[32m+[m
[32m+[m
[32m+[m[32mclass TitleSlideModel(BaseModel):[m
[32m+[m[32m    """Pydanticæ¨¡å‹ï¼šç”¨äº 'title' å¹»ç¯ç‰‡"""[m
[32m+[m
[32m+[m[32m    title: str = Field(..., description="å¹»ç¯ç‰‡ä¸»æ ‡é¢˜")[m
[32m+[m[32m    subtitle: str = Field(..., description="å¹»ç¯ç‰‡å‰¯æ ‡é¢˜")[m
[32m+[m
[32m+[m
[32m+[m[32mclass ContentSlideModel(BaseModel):[m
[32m+[m[32m    """Pydanticæ¨¡å‹ï¼šç”¨äº 'content' å¹»ç¯ç‰‡"""[m
[32m+[m
[32m+[m[32m    title: str = Field(..., description="å¹»ç¯ç‰‡æ ‡é¢˜")[m
[32m+[m[32m    content: List[str] = Field(..., description="å†…å®¹è¦ç‚¹åˆ—è¡¨")[m
[32m+[m
[32m+[m
[32m+[m[32mclass TwoColumnSlideModel(BaseModel):[m
[32m+[m[32m    """Pydanticæ¨¡å‹ï¼šç”¨äº 'two_column' å¹»ç¯ç‰‡"""[m
[32m+[m
[32m+[m[32m    title: str = Field(..., description="å¹»ç¯ç‰‡æ ‡é¢˜")[m
[32m+[m[32m    left_content: List[str] = Field(..., description="å·¦æ å†…å®¹è¦ç‚¹åˆ—è¡¨")[m
[32m+[m[32m    right_content: List[str] = Field(..., description="å³æ å†…å®¹è¦ç‚¹åˆ—è¡¨")[m
[32m+[m
[32m+[m
[32m+[m[32m# --- 2. ç³»ç»ŸæŒ‡ä»¤ (V1 æ¶æ„) ---[m
[32m+[m[32m# V1 æ¶æ„çš„ Prompt æ›´ç®€å•ï¼Œåªå…³æ³¨å½“å‰ä»»åŠ¡ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ¼”ç¤ºæ–‡ç¨¿[m
[32m+[m[32mSYSTEM_PROMPT_BASE = """[ç³»ç»ŸæŒ‡ä»¤][m
[32m+[m[32mä½ æ˜¯ä¸€åPPTå†…å®¹ä¸“å®¶ã€‚ä½ çš„å”¯ä¸€ç›®æ ‡æ˜¯ç”Ÿæˆå®¢è§‚ã€æ•°æ®é©±åŠ¨çš„æ–‡æœ¬ã€‚æ‰€æœ‰ä¿¡æ¯å¿…é¡»ä¸¥æ ¼åŸºäºä½ èƒ½å¤ŸæŸ¥é˜…åˆ°çš„æœ€æ–°ã€å¯éªŒè¯çš„èµ„æ–™ã€‚[m
[32m+[m[32mç»å¯¹ç¦æ­¢åŠ å…¥ä»»ä½•ä¸»è§‚æ„è§ã€æƒ…æ„Ÿè¡¨è¾¾æˆ–æ¨æµ‹æ€§å†…å®¹ã€‚[m
[32m+[m[32mä½ å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ Pydantic JSON æ ¼å¼è¾“å‡ºã€‚[m
[32m+[m[32m"""[m
[32m+[m
[32m+[m[32m# --- 3. å†…å®¹ç”Ÿæˆå™¨æœåŠ¡ (V1 æ¶æ„) ---[m
[32m+[m
[32m+[m
[32m+[m[32mclass ContentGeneratorV1:[m
[32m+[m[32m    """[m
[32m+[m[32m    å†…å®¹ç”ŸæˆæœåŠ¡ (V1 æ¶æ„)ã€‚[m
[32m+[m
[32m+[m[32m    Python è´Ÿè´£ç¼–æ’å¤§çº² (Oulline)ï¼ŒLLM è´Ÿè´£é€é¡µå¡«å……å†…å®¹ã€‚[m
[32m+[m[32m    """[m
[32m+[m
[32m+[m[32m    def __init__(self, template_engine: TemplateEngine):[m
[32m+[m[32m        """[m
[32m+[m[32m        åˆå§‹åŒ–å†…å®¹ç”Ÿæˆå™¨ã€‚[m
[32m+[m
[32m+[m[32m        Args:[m
[32m+[m[32m            template_engine (TemplateEngine): å·²åˆå§‹åŒ–çš„ TemplateEngine å®ä¾‹ (ä¾èµ–æ³¨å…¥)ã€‚[m
[32m+[m[32m        """[m
[32m+[m[32m        self.template_engine = template_engine[m
[32m+[m[32m        self.api_key = os.environ.get("DEEPSEEK_API_KEY")[m
[32m+[m
[32m+[m[32m        if not self.api_key:[m
[32m+[m[32m            logger.warning("DEEPSEEK_API_KEY ç¯å¢ƒå˜é‡æœªè®¾ç½®ã€‚APIè°ƒç”¨å°†å¤±è´¥ã€‚")[m
[32m+[m[32m            raise ValueError("DEEPSEEK_API_KEY æœªè®¾ç½®")[m
[32m+[m
[32m+[m[32m        # åˆå§‹åŒ– LangChain[m
[32m+[m[32m        try:[m
[32m+[m[32m            self.llm = ChatDeepSeek([m
[32m+[m[32m                model="deepseek-chat", temperature=0, api_key=self.api_key[m
[32m+[m[32m            )[m
[32m+[m
[32m+[m[32m            # V1 æ¶æ„ï¼šä¸ºæ¯ç§å¹»ç¯ç‰‡ç±»å‹åˆ›å»ºç‹¬ç«‹çš„ LLM é“¾[m
[32m+[m
[32m+[m[32m            # 1. æ ‡é¢˜é¡µç”Ÿæˆé“¾[m
[32m+[m[32m            self.title_chain = ChatPromptTemplate.from_messages([m
[32m+[m[32m                [[m
[32m+[m[32m                    ("system", SYSTEM_PROMPT_BASE),[m
[32m+[m[32m                    ("user", "ä¸ºä¸»é¢˜ '{topic}' ç”Ÿæˆä¸€å¼ å°é¢å¹»ç¯ç‰‡ï¼ˆæ ‡é¢˜å’Œå‰¯æ ‡é¢˜ï¼‰ã€‚"),[m
[32m+[m[32m                ][m
[32m+[m[32m            ) | self.llm.with_structured_output(TitleSlideModel)[m
[32m+[m
[32m+[m[32m            # 2. åŒæ é¡µç”Ÿæˆé“¾[m
[32m+[m[32m            self.two_column_chain = ChatPromptTemplate.from_messages([m
[32m+[m[32m                [[m
[32m+[m[32m                    ("system", SYSTEM_PROMPT_BASE),[m
[32m+[m[32m                    ([m
[32m+[m[32m                        "user",[m
[32m+[m[32m                        "ä¸ºæ¼”ç¤ºæ–‡ç¨¿ '{main_topic}'ï¼Œç”Ÿæˆä¸€å¼ å…³äºå­ä¸»é¢˜ '{sub_topic}' çš„åŒæ å¹»ç¯ç‰‡ã€‚å°† '{topic1}' æ”¾åœ¨å·¦æ ï¼Œ'{topic2}' æ”¾åœ¨å³æ ã€‚",[m
[32m+[m[32m                    ),[m
[32m+[m[32m                ][m
[32m+[m[32m            ) | self.llm.with_structured_output(TwoColumnSlideModel)[m
[32m+[m
[32m+[m[32m            # 3. æ€»ç»“é¡µç”Ÿæˆé“¾[m
[32m+[m[32m            self.content_chain = ChatPromptTemplate.from_messages([m
[32m+[m[32m                [[m
[32m+[m[32m                    ("system", SYSTEM_PROMPT_BASE),[m
[32m+[m[32m                    ("user", "ä¸ºæ¼”ç¤ºæ–‡ç¨¿ '{main_topic}' ç”Ÿæˆä¸€å¼ æ€»ç»“å’Œå±•æœ›å¹»ç¯ç‰‡ã€‚"),[m
[32m+[m[32m                ][m
[32m+[m[32m            ) | self.llm.with_structured_output(ContentSlideModel)[m
[32m+[m
[32m+[m[32m        except Exception as e:[m
[32m+[m[32m            logger.error(f"åˆå§‹åŒ–LangChainå¤±è´¥: {e}")[m
[32m+[m[32m            raise[m
[32m+[m
[32m+[m[32m    def generate_ppt_data_v1([m
[32m+[m[32m        self, main_topic: str, outline: List[Dict[str, str]], summary_topic: str[m
[32m+[m[32m    ) -> List[Dict[str, Any]]:[m
[32m+[m[32m        """[m
[32m+[m[32m        [V1 æ¶æ„æ ¸å¿ƒ] æ­¥éª¤ 1: æ ¹æ®å¤§çº²ï¼Œå¾ªç¯è°ƒç”¨ LLM ç”Ÿæˆå¹»ç¯ç‰‡æ•°æ®ã€‚[m
[32m+[m
[32m+[m[32m        Args:[m
[32m+[m[32m            main_topic (str): æ¼”ç¤ºæ–‡ç¨¿çš„ä¸»é¢˜ã€‚[m
[32m+[m[32m            outline (List[Dict]): Python å®šä¹‰çš„ PPT å¤§çº²ã€‚[m
[32m+[m[32m            summary_topic (str): æ€»ç»“å¹»ç¯ç‰‡çš„ä¸»é¢˜ã€‚[m
[32m+[m
[32m+[m[32m        Returns:[m
[32m+[m[32m            List[Dict[str, Any]]: æ ¼å¼åŒ–çš„æ•°æ®ã€‚[m
[32m+[m[32m        """[m
[32m+[m[32m        slides_data = [][m
[32m+[m[32m        logger.info([m
[32m+[m[32m            f"V1 æ¶æ„ï¼šå¼€å§‹ä¸º '{main_topic}' ç”Ÿæˆ {len(outline) + 2} å¼ å¹»ç¯ç‰‡..."[m
[32m+[m[32m        )[m
[32m+[m
[32m+[m[32m        try:[m
[32m+[m[32m            # 1. ç”Ÿæˆæ ‡é¢˜é¡µ[m
[32m+[m[32m            logger.info("  æ­£åœ¨ç”Ÿæˆ [Title Slide]...")[m
[32m+[m[32m            title_model = self.title_chain.invoke({"topic": main_topic})[m
[32m+[m[32m            slides_data.append([m
[32m+[m[32m                {[m
[32m+[m[32m                    "slide_type": "title",[m
[32m+[m[32m                    "title": title_model.title,[m
[32m+[m[32m                    "subtitle": title_model.subtitle,[m
[32m+[m[32m                }[m
[32m+[m[32m            )[m
[32m+[m
[32m+[m[32m            # 2. å¾ªç¯ç”ŸæˆåŒæ é¡µ[m
[32m+[m[32m            for i, item in enumerate(outline):[m
[32m+[m[32m                logger.info([m
[32m+[m[32m                    f"  æ­£åœ¨ç”Ÿæˆ [Two Column Slide {i+1}/{len(outline)}]ï¼š{item['sub_topic']}..."[m
[32m+[m[32m                )[m
[32m+[m[32m                # [CTO Note - P2 ä¿®å¤]: å¼‚å¸¸æ•è·ç²’åº¦æ›´ç»†[m
[32m+[m[32m                try:[m
[32m+[m[32m                    two_col_model = self.two_column_chain.invoke([m
[32m+[m[32m                        {[m
[32m+[m[32m                            "main_topic": main_topic,[m
[32m+[m[32m                            "sub_topic": item["sub_topic"],[m
[32m+[m[32m                            "topic1": item["topic1"],[m
[32m+[m[32m                            "topic2": item["topic2"],[m
[32m+[m[32m                        }[m
[32m+[m[32m                    )[m
[32m+[m[32m                    slides_data.append([m
[32m+[m[32m                        {[m
[32m+[m[32m                            "slide_type": "two_column",[m
[32m+[m[32m                            "title": two_col_model.title,[m
[32m+[m[32m                            "left_content": two_col_model.left_content,[m
[32m+[m[32m                            "right_content": two_col_model.right_content,[m
[32m+[m[32m                        }[m
[32m+[m[32m                    )[m
[32m+[m[32m                except (ValidationError, OutputParserException) as e:[m
[32m+[m[32m                    logger.error(f"  è§£æ {item['sub_topic']} å¤±è´¥ï¼Œè·³è¿‡æ­¤å¹»ç¯ç‰‡: {e}")[m
[32m+[m[32m                except Exception as e:[m
[32m+[m[32m                    logger.error([m
[32m+[m[32m                        f"  API è°ƒç”¨ {item['sub_topic']} å¤±è´¥ï¼Œè·³è¿‡æ­¤å¹»ç¯ç‰‡: {e}"[m
[32m+[m[32m                    )[m
[32m+[m
[32m+[m[32m            # 3. ç”Ÿæˆæ€»ç»“é¡µ[m
[32m+[m[32m            logger.info("  æ­£åœ¨ç”Ÿæˆ [Content Slide] (æ€»ç»“)...")[m
[32m+[m[32m            content_model = self.content_chain.invoke([m
[32m+[m[32m                {"main_topic": main_topic, "summary_topic": summary_topic}[m
[32m+[m[32m            )[m
[32m+[m[32m            slides_data.append([m
[32m+[m[32m                {[m
[32m+[m[32m                    "slide_type": "content",[m
[32m+[m[32m                    "title": content_model.title,[m
[32m+[m[32m                    "content": content_model.content,[m
[32m+[m[32m                }[m
[32m+[m[32m            )[m
[32m+[m
[32m+[m[32m            logger.info(f"V1 æ¶æ„ï¼šå†…å®¹ç”Ÿæˆå®Œæ¯•ï¼Œå…± {len(slides_data)} å¼ å¹»ç¯ç‰‡ã€‚")[m
[32m+[m[32m            return slides_data[m
[32m+[m
[32m+[m[32m        except Exception as e:[m
[32m+[m[32m            # [CTO Note - P3 ä¿®å¤]: ä»…åœ¨å¯åŠ¨é˜¶æ®µå¤±è´¥æ—¶ä½¿ç”¨å›é€€[m
[32m+[m[32m            logger.error(f"V1 æ¶æ„å¯åŠ¨å¤±è´¥ (ä¾‹å¦‚æ ‡é¢˜é¡µç”Ÿæˆå¤±è´¥): {e}")[m
[32m+[m[32m            logger.warning("è¿”å›ç¡¬ç¼–ç çš„å›é€€æ•°æ®ã€‚")[m
[32m+[m[32m            return self.get_fallback_data(main_topic)[m
[32m+[m
[32m+[m[32m    def create_ppt_file([m
[32m+[m[32m        self, slides_data: List[Dict[str, Any]], output_title: str[m
[32m+[m[32m    ) -> Dict[str, Any]:[m
[32m+[m[32m        """[m
[32m+[m[32m        æ­¥éª¤ 2: è°ƒç”¨ TemplateEngine ç”Ÿæˆ PPTX æ–‡ä»¶ã€‚[m
[32m+[m[32m        """[m
[32m+[m[32m        logger.info(f"æ­£åœ¨è°ƒç”¨ TemplateEngine ç”Ÿæˆ '{output_title}.pptx'...")[m
[32m+[m[32m        return self.template_engine.create_from_template([m
[32m+[m[32m            title=output_title, slides_data=slides_data[m
[32m+[m[32m        )[m
[32m+[m
[32m+[m[32m    def get_fallback_data(self, topic: str) -> List[Dict[str, Any]]:[m
[32m+[m[32m        """[P3 ä¿®å¤] æä¾›åŠ¨æ€æ ‡é¢˜çš„å›é€€æ•°æ®ã€‚"""[m
[32m+[m[32m        return [[m
[32m+[m[32m            {[m
[32m+[m[32m                "slide_type": "title",[m
[32m+[m[32m                "title": f"{topic} åˆ†ææŠ¥å‘Š (å›é€€æ•°æ®)",[m
[32m+[m[32m                "subtitle": "LLM API è°ƒç”¨å¤±è´¥",[m
[32m+[m[32m            },[m
[32m+[m[32m            {[m
[32m+[m[32m                "slide_type": "content",[m
[32m+[m[32m                "title": "é”™è¯¯",[m
[32m+[m[32m                "content": [[m
[32m+[m[32m                    "å†…å®¹ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥ API å¯†é’¥æˆ–ç½‘ç»œè¿æ¥ã€‚",[m
[32m+[m[32m                    "è¿™æ˜¯ä¸€ä¸ªå›é€€æ•°æ®ç¤ºä¾‹ã€‚",[m
[32m+[m[32m                ],[m
[32m+[m[32m            },[m
[32m+[m[32m        ][m
[41m+[m
[1mdiff --git a/mvp_fastapi/services/design.py b/mvp_fastapi/services/design.py[m
[1mindex 4504a54..5138d3e 100644[m
[1m--- a/mvp_fastapi/services/design.py[m
[1m+++ b/mvp_fastapi/services/design.py[m
[36m@@ -1 +1,468 @@[m
[31m-# è®¾è®¡ç¾åŒ–æœåŠ¡ï¼Œåº”ç”¨æ¨¡æ¿å’Œæ ·å¼åˆ°PPTå†…å®¹[m
\ No newline at end of file[m
[32m+[m[32m"""[m
[32m+[m[32mè®¾è®¡ç¾åŒ–æœåŠ¡æ¨¡å—ã€‚[m
[32m+[m
[32m+[m[32mè¯¥æ¨¡å—è´Ÿè´£åº”ç”¨æ¨¡æ¿å’Œæ ·å¼åˆ°PPTå†…å®¹ï¼Œæ”¯æŒOfficeå®˜æ–¹å…è´¹æ¨¡æ¿ã€‚[m
[32m+[m[32mRefactored according to Google Engineering Practices.[m
[32m+[m[32m"""[m
[32m+[m
[32m+[m[32mimport os[m
[32m+[m[32mimport logging[m
[32m+[m[32mimport io[m
[32m+[m[32mfrom typing import Dict, Any, List, Optional, Union[m
[32m+[m
[32m+[m[32mfrom pptx import Presentation[m
[32m+[m[32mfrom pptx.slide import SlideLayout, Slide[m
[32m+[m[32mfrom pptx.util import Inches[m
[32m+[m
[32m+[m
[32m+[m[32m# å‡è®¾ exporter æ¨¡å—å­˜åœ¨ (ä½¿ç”¨ Mock æ¥é¿å…å¾ªç¯ä¾èµ–)[m
[32m+[m[32m# åœ¨å®é™…è¿è¡Œæ—¶ï¼Œåº”ä¿è¯ 'from .exporter import PPTExporter' å¯ç”¨[m
[32m+[m[32mclass PPTExporter:[m
[32m+[m[32m    """Mock Exporter for testing purposes."""[m
[32m+[m
[32m+[m[32m    def export_ppt(self, prs: Presentation, title: str) -> Dict[str, Any]:[m
[32m+[m[32m        # æ¨¡æ‹Ÿå¯¼å‡ºï¼šå°† prs ä¿å­˜åˆ° BytesIO[m
[32m+[m[32m        buffer = io.BytesIO()[m
[32m+[m[32m        prs.save(buffer)[m
[32m+[m[32m        buffer.seek(0)[m
[32m+[m[32m        return {"buffer": buffer, "filename": f"{title}.pptx"}[m
[32m+[m
[32m+[m
[32m+[m[32m# é…ç½®æ—¥å¿—[m
[32m+[m[32mlogger = logging.getLogger(__name__)[m
[32m+[m
[32m+[m
[32m+[m[32mclass TemplateEngine:[m
[32m+[m[32m    """PPTæ¨¡æ¿å¼•æ“ç±»ï¼Œè´Ÿè´£åº”ç”¨æ¨¡æ¿å’Œæ ·å¼åˆ°PPTå†…å®¹ã€‚"""[m
[32m+[m
[32m+[m[32m    # æ ¹æ®ç”¨æˆ·æä¾›çš„æ—¥å¿—ï¼Œé€‚é…æ¨¡æ¿å¸ƒå±€åç§°[m
[32m+[m[32m    LAYOUT_NAMES = {[m
[32m+[m[32m        "title": "Title 1",  # LAYOUT 0[m
[32m+[m[32m        "content": "Title and Content",  # LAYOUT 4[m
[32m+[m[32m        "two_column": "Title and two Content 1",  # LAYOUT 6[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    # å›é€€ç´¢å¼•ï¼Œé˜²æ­¢åç§°åŒ¹é…å¤±è´¥[m
[32m+[m[32m    LAYOUT_INDICES = {"title": 0, "content": 4, "two_column": 6}[m
[32m+[m
[32m+[m[32m    def __init__([m
[32m+[m[32m        self,[m
[32m+[m[32m        exporter: PPTExporter,[m
[32m+[m[32m        template_path: str = "templates/business_report.pptx",[m
[32m+[m[32m    ):[m
[32m+[m[32m        self.exporter = exporter[m
[32m+[m[32m        self.template_path = template_path[m
[32m+[m
[32m+[m[32m    def create_from_template([m
[32m+[m[32m        self,[m
[32m+[m[32m        title: str = "æ¼”ç¤ºæ–‡ç¨¿",[m
[32m+[m[32m        slides_data: Optional[List[Dict[str, Any]]] = None,[m
[32m+[m[32m    ) -> Dict[str, Any]:[m
[32m+[m[32m        """ä½¿ç”¨æ¨¡æ¿åˆ›å»ºPPTå¹¶è¿›è¡Œå†…å®¹ä¿®æ”¹ã€‚"""[m
[32m+[m[32m        prs = self._load_resource()[m
[32m+[m
[32m+[m[32m        # æ ¸å¿ƒæ­¥éª¤ 1: æ¸…ç†ç°æœ‰å¹»ç¯ç‰‡ (ä¿ç•™æ¯ç‰ˆæ ·å¼)[m
[32m+[m[32m        self._clear_existing_slides(prs)[m
[32m+[m
[32m+[m[32m        # æ ¸å¿ƒæ­¥éª¤ 2: æ„å»ºå†…å®¹[m
[32m+[m[32m        if not slides_data:[m
[32m+[m[32m            self._create_title_slide(prs, title)[m
[32m+[m[32m        else:[m
[32m+[m[32m            for i, slide_info in enumerate(slides_data):[m
[32m+[m[32m                try:[m
[32m+[m[32m                    # å®¹é”™æœºåˆ¶ï¼šå³ä½¿å•å¼ å¤±è´¥ï¼Œä¹Ÿè¦ç»§ç»­å°è¯•ä¸‹ä¸€å¼ [m
[32m+[m[32m                    self._create_slide_by_type(prs, slide_info, i)[m
[32m+[m[32m                except Exception as e:[m
[32m+[m[32m                    logger.error(f"åˆ›å»ºç¬¬ {i+1} å¼ å¹»ç¯ç‰‡å¤±è´¥: {str(e)}")[m
[32m+[m
[32m+[m[32m        return self.exporter.export_ppt(prs, title=title)[m
[32m+[m
[32m+[m[32m    def _load_resource(self) -> Presentation:[m
[32m+[m[32m        """åŠ è½½æ¨¡æ¿èµ„æºï¼Œå¸¦æœ‰å®¹é”™å¤„ç†ã€‚"""[m
[32m+[m[32m        if os.path.exists(self.template_path):[m
[32m+[m[32m            logger.info(f"åŠ è½½æ¨¡æ¿: {self.template_path}")[m
[32m+[m[32m            return Presentation(self.template_path)[m
[32m+[m[32m        else:[m
[32m+[m[32m            logger.warning(f"æ¨¡æ¿æœªæ‰¾åˆ°: {self.template_path}ï¼Œé™çº§ä¸ºåˆ›å»ºç©ºç™½PPT")[m
[32m+[m[32m            return Presentation()[m
[32m+[m
[32m+[m[32m    def _clear_existing_slides(self, prs: Presentation) -> None:[m
[32m+[m[32m        """æ¸…ç©ºç°æœ‰å¹»ç¯ç‰‡ (ç§æœ‰ API æ“ä½œï¼Œé«˜é£é™©)ã€‚"""[m
[32m+[m[32m        try:[m
[32m+[m[32m            xml_slides = prs.slides._sldIdLst[m
[32m+[m[32m            slides_count = len(xml_slides)[m
[32m+[m[32m            # å€’åºåˆ é™¤[m
[32m+[m[32m            for i in range(slides_count - 1, -1, -1):[m
[32m+[m[32m                rId = xml_slides[i].rId[m
[32m+[m[32m                prs.part.drop_rel(rId)[m
[32m+[m[32m                del xml_slides[i][m
[32m+[m[32m        except Exception as e:[m
[32m+[m[32m            logger.error(f"æ¸…ç†å¹»ç¯ç‰‡æ—¶å‘ç”Ÿé”™è¯¯ (éè‡´å‘½): {str(e)}")[m
[32m+[m
[32m+[m[32m    def _get_layout(self, prs: Presentation, layout_key: str) -> SlideLayout:[m
[32m+[m[32m        """æ ¹æ®åç§°å®‰å…¨è·å–å¸ƒå±€ (ä¼˜å…ˆåç§°åŒ¹é…ï¼Œå…¶æ¬¡ç´¢å¼•å›é€€)ã€‚"""[m
[32m+[m[32m        target_name = self.LAYOUT_NAMES.get(layout_key)[m
[32m+[m
[32m+[m[32m        # 1. å°è¯•é€šè¿‡åç§°æŸ¥æ‰¾ (Plan A)[m
[32m+[m[32m        for layout in prs.slide_layouts:[m
[32m+[m[32m            if layout.name == target_name:[m
[32m+[m[32m                return layout[m
[32m+[m
[32m+[m[32m        # 2. å›é€€åˆ°ç´¢å¼•æŸ¥æ‰¾ (Plan B)[m
[32m+[m[32m        fallback_index = self.LAYOUT_INDICES.get(layout_key, 1)[m
[32m+[m[32m        logger.warning(f"å¸ƒå±€ '{target_name}' æœªæ‰¾åˆ°ï¼Œå›é€€ä½¿ç”¨ç´¢å¼• {fallback_index}")[m
[32m+[m
[32m+[m[32m        if fallback_index < len(prs.slide_layouts):[m
[32m+[m[32m            return prs.slide_layouts[fallback_index][m
[32m+[m
[32m+[m[32m        # 3. æœ€ç»ˆå›é€€ (ä¿åº•)[m
[32m+[m[32m        logger.error("è¯·æ±‚çš„å¸ƒå±€ç´¢å¼•è¶…å‡ºèŒƒå›´ï¼Œä½¿ç”¨é»˜è®¤å¸ƒå±€ [0]")[m
[32m+[m[32m        return prs.slide_layouts[0][m
[32m+[m
[32m+[m[32m    def _get_body_placeholders(self, slide: Union[Slide, SlideLayout]) -> List[Any]:[m
[32m+[m[32m        """æ™ºèƒ½è·å–æ­£æ–‡å ä½ç¬¦ï¼Œè¿‡æ»¤æ‰ Title/Slide Number ç­‰æ— å…³æ¡†ã€‚"""[m
[32m+[m[32m        body_placeholders = [][m
[32m+[m[32m        for p in slide.placeholders:[m
[32m+[m[32m            name = p.name[m
[32m+[m[32m            # è¿‡æ»¤æ‰æ‰€æœ‰æ ‡é¢˜ã€å›¾ç‰‡ã€é¡µç ã€è¡¨æ ¼ç›¸å…³çš„å ä½ç¬¦[m
[32m+[m[32m            if not any([m
[32m+[m[32m                keyword in name[m
[32m+[m[32m                for keyword in ["Title", "Picture", "Slide Number", "Table"][m
[32m+[m[32m            ):[m
[32m+[m[32m                body_placeholders.append(p)[m
[32m+[m
[32m+[m[32m        # æŒ‰ä½ç½®æ’åºï¼šç¡®ä¿å·¦ä¾§å†…å®¹å¡«å…¥å·¦è¾¹çš„æ¡† (top, left)[m
[32m+[m[32m        body_placeholders.sort(key=lambda p: (p.top, p.left))[m
[32m+[m
[32m+[m[32m        # å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç²¾ç¡®çš„éæ ‡é¢˜æ¡†ï¼Œå°è¯•æ”¾å®½æ¡ä»¶ (åªæ’é™¤ Title å’Œ Slide Number)[m
[32m+[m[32m        if not body_placeholders:[m
[32m+[m[32m            for p in slide.placeholders:[m
[32m+[m[32m                name = p.name[m
[32m+[m[32m                if not any(keyword in name for keyword in ["Title", "Slide Number"]):[m
[32m+[m[32m                    body_placeholders.append(p)[m
[32m+[m[32m            body_placeholders.sort(key=lambda p: (p.top, p.left))[m
[32m+[m
[32m+[m[32m        return body_placeholders[m
[32m+[m
[32m+[m[32m    def _create_title_slide(self, prs: Presentation, title: str, subtitle: str = ""):[m
[32m+[m[32m        """åˆ›å»ºæ ‡é¢˜å¹»ç¯ç‰‡ã€‚"""[m
[32m+[m[32m        layout = self._get_layout(prs, "title")[m
[32m+[m[32m        slide = prs.slides.add_slide(layout)[m
[32m+[m
[32m+[m[32m        if slide.shapes.title:[m
[32m+[m[32m            slide.shapes.title.text = title[m
[32m+[m
[32m+[m[32m        # ä½¿ç”¨åŠ¨æ€æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¯ç”¨å†…å®¹æ¡†ä½œä¸ºå‰¯æ ‡é¢˜[m
[32m+[m[32m        body_placeholders = self._get_body_placeholders(slide)[m
[32m+[m[32m        if subtitle and body_placeholders:[m
[32m+[m[32m            self._set_placeholder_content(body_placeholders[0], subtitle)[m
[32m+[m
[32m+[m[32m    def _create_content_slide(self, prs: Presentation, title: str, content: Any):[m
[32m+[m[32m        """åˆ›å»ºå†…å®¹å¹»ç¯ç‰‡ã€‚"""[m
[32m+[m[32m        layout = self._get_layout(prs, "content")[m
[32m+[m[32m        slide = prs.slides.add_slide(layout)[m
[32m+[m
[32m+[m[32m        if slide.shapes.title:[m
[32m+[m[32m            slide.shapes.title.text = title[m
[32m+[m
[32m+[m[32m        # ä½¿ç”¨åŠ¨æ€æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¯ç”¨å†…å®¹æ¡†[m
[32m+[m[32m        body_placeholders = self._get_body_placeholders(slide)[m
[32m+[m[32m        if body_placeholders:[m
[32m+[m[32m            self._set_placeholder_content(body_placeholders[0], content)[m
[32m+[m[32m        else:[m
[32m+[m[32m            logger.warning([m
[32m+[m[32m                f"å¹»ç¯ç‰‡ '{title}' çš„å¸ƒå±€ ({layout.name}) ç¼ºå°‘å¯ç”¨å†…å®¹å ä½ç¬¦ã€‚"[m
[32m+[m[32m            )[m
[32m+[m
[32m+[m[32m    def _create_two_column_slide([m
[32m+[m[32m        self, prs: Presentation, title: str, left_content: Any, right_content: Any[m
[32m+[m[32m    ):[m
[32m+[m[32m        """åˆ›å»ºä¸¤æ å¹»ç¯ç‰‡ã€‚"""[m
[32m+[m[32m        layout = self._get_layout(prs, "two_column")[m
[32m+[m[32m        slide = prs.slides.add_slide(layout)[m
[32m+[m
[32m+[m[32m        if slide.shapes.title:[m
[32m+[m[32m            slide.shapes.title.text = title[m
[32m+[m
[32m+[m[32m        # ä½¿ç”¨åŠ¨æ€æŸ¥æ‰¾å’Œæ’åºåçš„å ä½ç¬¦[m
[32m+[m[32m        body_placeholders = self._get_body_placeholders(slide)[m
[32m+[m
[32m+[m[32m        # æ™ºèƒ½åˆ†é…å†…å®¹[m
[32m+[m[32m        if len(body_placeholders) >= 1:[m
[32m+[m[32m            self._set_placeholder_content(body_placeholders[0], left_content)[m
[32m+[m
[32m+[m[32m        if len(body_placeholders) >= 2:[m
[32m+[m[32m            self._set_placeholder_content(body_placeholders[1], right_content)[m
[32m+[m[32m        elif len(body_placeholders) == 1:[m
[32m+[m[32m            logger.warning(f"ä¸¤æ å¹»ç¯ç‰‡ '{title}' åªæœ‰ä¸€ä¸ªå†…å®¹æ¡†ï¼Œå³ä¾§å†…å®¹å°†è¢«å¿½ç•¥ã€‚")[m
[32m+[m[32m        else:[m
[32m+[m[32m            logger.warning(f"ä¸¤æ å¹»ç¯ç‰‡ '{title}' æ²¡æœ‰ä»»ä½•å¯ç”¨å†…å®¹æ¡†ã€‚")[m
[32m+[m
[32m+[m[32m    def _set_placeholder_content(self, placeholder: Any, content: Any):[m
[32m+[m[32m        """è®¾ç½®å ä½ç¬¦å†…å®¹ï¼Œæ”¯æŒæ–‡æœ¬å’Œåˆ—è¡¨ã€‚"""[m
[32m+[m[32m        if not hasattr(placeholder, "text_frame"):[m
[32m+[m[32m            return[m
[32m+[m
[32m+[m[32m        text_frame = placeholder.text_frame[m
[32m+[m[32m        text_frame.clear()  # æ¸…ç©ºé»˜è®¤æ–‡æœ¬[m
[32m+[m
[32m+[m[32m        if isinstance(content, list):[m
[32m+[m[32m            # å°†åˆ—è¡¨é¡¹è½¬ä¸ºå¸¦é¡¹ç›®ç¬¦å·çš„æ®µè½[m
[32m+[m[32m            for i, item in enumerate(content):[m
[32m+[m[32m                if i == 0:[m
[32m+[m[32m                    p = text_frame.paragraphs[0][m
[32m+[m[32m                else:[m
[32m+[m[32m                    p = text_frame.add_paragraph()[m
[32m+[m[32m                p.text = str(item)[m
[32m+[m[32m        else:[m
[32m+[m[32m            text_frame.text = str(content)[m
[32m+[m
[32m+[m[32m    def _create_slide_by_type([m
[32m+[m[32m        self, prs: Presentation, slide_info: Dict[str, Any], index: int[m
[32m+[m[32m    ):[m
[32m+[m[32m        """å·¥å‚åˆ†å‘æ–¹æ³•ã€‚"""[m
[32m+[m[32m        slide_type = slide_info.get("slide_type", "content")[m
[32m+[m[32m        title = slide_info.get("title", f"å¹»ç¯ç‰‡ {index+1}")[m
[32m+[m
[32m+[m[32m        if slide_type == "title":[m
[32m+[m[32m            self._create_title_slide(prs, title, slide_info.get("subtitle", ""))[m
[32m+[m[32m        elif slide_type == "two_column":[m
[32m+[m[32m            self._create_two_column_slide([m
[32m+[m[32m                prs,[m
[32m+[m[32m                title,[m
[32m+[m[32m                slide_info.get("left_content", ""),[m
[32m+[m[32m                slide_info.get("right_content", ""),[m
[32m+[m[32m            )[m
[32m+[m[32m        else:[m
[32m+[m[32m            self._create_content_slide(prs, title, slide_info.get("content", ""))[m
[32m+[m
[32m+[m
[32m+[m[32m# ä½¿ç”¨ç¤ºä¾‹ (Usage Example)[m
[32m+[m[32mif __name__ == "__main__":[m
[32m+[m[32m    # æ¿€æ´»æ—¥å¿—é…ç½®[m
[32m+[m[32m    logging.basicConfig([m
[32m+[m[32m        level=logging.INFO, format="%(asctime)s - %(levelname)s - %(message)s"[m
[32m+[m[32m    )[m
[32m+[m
[32m+[m[32m    import io[m
[32m+[m
[32m+[m[32m    # 1. å®ä¾‹åŒ–ä¾èµ– (ä½¿ç”¨ Mock)[m
[32m+[m[32m    ppt_exporter = PPTExporter()[m
[32m+[m
[32m+[m[32m    # 2. æ³¨å…¥ä¾èµ–å¹¶åˆ›å»ºæœåŠ¡[m
[32m+[m[32m    # ç¡®ä¿ template_path æŒ‡å‘å®é™…å­˜åœ¨çš„ pptx æ–‡ä»¶[m
[32m+[m[32m    engine = TemplateEngine([m
[32m+[m[32m        exporter=ppt_exporter, template_path="templates/business_report.pptx"[m
[32m+[m[32m    )[m
[32m+[m
[32m+[m[32m    # 3. å‡†å¤‡æµ‹è¯•æ•°æ® (NVIDIA FY2026 Q2 è´¢æŠ¥æ•°æ®)[m
[32m+[m[32m    sample_data = [[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "title",[m
[32m+[m[32m            "title": "2025å¹´å…¨çƒç”µåŠ¨æ±½è½¦(EV)å¸‚åœºåˆ†ææŠ¥å‘Š",[m
[32m+[m[32m            "subtitle": "æŠ€æœ¯ã€å¸‚åœºä»½é¢ä¸æœªæ¥è¶‹åŠ¿",[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "å…¨çƒé”€é‡é¢†å¯¼è€… (2025å¹´1-9æœˆ)",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "æ¯”äºšè¿ª (BYD):",[m
[32m+[m[32m                "çº¯ç”µæ±½è½¦ (BEV) ç´¯è®¡é”€é‡: çº¦ 161 ä¸‡è¾†ã€‚",[m
[32m+[m[32m                "é¢„è®¡ 2025 å¹´å…¨çƒå¸‚åœºä»½é¢å°†è¾¾åˆ° 15.7%ã€‚",[m
[32m+[m[32m                "å·²è¿ç»­å››ä¸ªå­£åº¦ä¿æŒé”€é‡é¢†å…ˆã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "ç‰¹æ–¯æ‹‰ (Tesla):",[m
[32m+[m[32m                "çº¯ç”µæ±½è½¦ (BEV) ç´¯è®¡é”€é‡: çº¦ 122 ä¸‡è¾†ã€‚",[m
[32m+[m[32m                "åŒæœŸé”€é‡è½åæ¯”äºšè¿ªçº¦ 38.8 ä¸‡è¾†ã€‚",[m
[32m+[m[32m                "Q3 é”€é‡ä¸º 497,100 è¾†ï¼ŒåŒæ¯”å¢é•¿ 7.4%ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "åŒºåŸŸå¸‚åœºåŠ¨æ€ (2024-2025)",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "ä¸­å›½:",[m
[32m+[m[32m                "2024å¹´å å…¨çƒç”µåŠ¨æ±½è½¦é”€é‡çš„è¿‘ä¸‰åˆ†ä¹‹äºŒã€‚",[m
[32m+[m[32m                "ç»§ç»­å¼•é¢†å…¨çƒç”µåŠ¨æ±½è½¦å’Œå……ç”µè®¾æ–½çš„éƒ¨ç½²ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "æ¬§æ´²:",[m
[32m+[m[32m                "2024å¹´é”€é‡åœæ»ï¼Œå—ä¸»è¦å¸‚åœºï¼ˆå¦‚å¾·å›½ï¼‰è¡¥è´´å‡å°‘å½±å“ã€‚",[m
[32m+[m[32m                "2025 å¹´æ–° CO2 ç›®æ ‡ç”Ÿæ•ˆï¼Œé¢„è®¡å°†æ¨åŠ¨å¢é•¿ã€‚",[m
[32m+[m[32m                "æŒªå¨ä»æ˜¯é¢†å¯¼è€…ï¼ŒBEV å æ–°è½¦é”€é‡ 80% ä»¥ä¸Šã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "subtitle": "ä¸­ç¾æ¬§å¸‚åœºè¡¨ç°åˆ†åŒ–",[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "ç”µæ± æŠ€æœ¯å¯¹æ¯”ï¼šå›ºæ€ç”µæ±  vs é”‚ç¦»å­",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "å›ºæ€ç”µæ±  (SSB):",[m
[32m+[m[32m                "ç”µè§£è´¨: å›ºä½“ï¼ˆé™¶ç“·ã€èšåˆç‰©ï¼‰ã€‚",[m
[32m+[m[32m                "èƒ½é‡å¯†åº¦ (æ½œåŠ›): 350â€“700 Wh/kgã€‚",[m
[32m+[m[32m                "å®‰å…¨æ€§: æ›´é«˜ï¼Œæ— çƒ­å¤±æ§é£é™©ã€‚",[m
[32m+[m[32m                "å……ç”µé€Ÿåº¦ (ç›®æ ‡): 12-15 åˆ†é’Ÿè‡³ 80%ã€‚",[m
[32m+[m[32m                "ææ–™: éœ€å¤š 35% çš„é”‚ï¼Œä½†æ˜¾ç€å‡å°‘çŸ³å¢¨å’Œé’´ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "ä¼ ç»Ÿé”‚ç¦»å­ (LIB):",[m
[32m+[m[32m                "ç”µè§£è´¨: æ¶²ä½“æˆ–å‡èƒ¶ï¼ˆæ˜“ç‡ƒï¼‰ã€‚",[m
[32m+[m[32m                "èƒ½é‡å¯†åº¦ (å½“å‰): 150â€“300 Wh/kgã€‚",[m
[32m+[m[32m                "å®‰å…¨æ€§: å­˜åœ¨çƒ­å¤±æ§å’Œèµ·ç«é£é™©ã€‚",[m
[32m+[m[32m                "å……ç”µé€Ÿåº¦ (å½“å‰): 30-45 åˆ†é’Ÿè‡³ 80%ã€‚",[m
[32m+[m[32m                "ææ–™: ä¾èµ–é’´å’Œé•ï¼Œå›æ”¶å·¥è‰ºèƒ½è€—é«˜ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "å…³é”®ç”µæ± ææ–™ä¾›éœ€ (2025)",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "éœ€æ±‚å¢é•¿:",[m
[32m+[m[32m                "é¢„è®¡ 2025-2035 å¹´ï¼Œå…³é”®ç”µæ± ææ–™å¸‚åœºä»·å€¼å°†å¢é•¿ä¸‰å€ (CAGR 10.6%)ã€‚",[m
[32m+[m[32m                "é• (Nickel) çš„éœ€æ±‚å¢é•¿è¿…é€Ÿï¼Œé¢„è®¡å°†æˆä¸ºç»§é”‚å’Œé’´ä¹‹åçš„ä¸»è¦ææ–™ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "ä¾›åº”æŒ‘æˆ˜:",[m
[32m+[m[32m                "é’´ (Cobalt) éœ€æ±‚å¢é•¿é¢„è®¡æœ€æ…¢ï¼Œå›  LCO ç”µæ± å¸‚åœºä»½é¢ä¸‹é™ã€‚",[m
[32m+[m[32m                "é«˜å“ä½çŸ¿æºé€æ¸æ¯ç«­ï¼Œå¼€é‡‡è½¬å‘ä½å“ä½çŸ¿çŸ³ï¼Œå¢åŠ äº†ç»æµå’ŒæŠ€æœ¯æŒ‘æˆ˜ã€‚",[m
[32m+[m[32m                "çŸ­æœŸå†…å…³é”®çŸ¿ç‰©ä¾›åº”è¿…é€Ÿå¢åŠ ï¼Œå­˜åœ¨çŸ­æœŸè¿‡å‰©æ‹…å¿§ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "å……ç”µåŸºç¡€è®¾æ–½å¢é•¿",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "å…¨çƒæ¦‚å†µ:",[m
[32m+[m[32m                "æˆªè‡³ 2024 å¹´åº•ï¼Œå…¨çƒå…¬å…±å……ç”µç«™è¶… 500 ä¸‡ä¸ªï¼Œä¸¤å¹´å†…ç¿»å€ã€‚",[m
[32m+[m[32m                "ä¸­å›½æ‹¥æœ‰å…¨çƒçº¦ 65% çš„å…¬å…±å……ç”µæ¡©ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "åŒºåŸŸå·®å¼‚:",[m
[32m+[m[32m                "ç¾å›½å’Œè‹±å›½çš„ EV ä¸å……ç”µæ¡©æ¯”ä¾‹è¾ƒé«˜ï¼ŒåŸºç¡€è®¾æ–½éƒ¨ç½²è½åäºè½¦è¾†æ™®åŠé€Ÿåº¦ã€‚",[m
[32m+[m[32m                "æ¬§ç›Ÿæ³•è§„è¦æ±‚ä» 2025 å¹´èµ·ï¼Œä¸»è¦è¿è¾“è·¯çº¿æ¯ 60 å…¬é‡Œå¿…é¡»å®‰è£…å……ç”µç‚¹ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "å……ç”µæ ‡å‡†ä¸ç½‘ç»œè”ç›Ÿ (2025)",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "åŒ—ç¾å……ç”µæ ‡å‡† (NACS):",[m
[32m+[m[32m                "ç‰¹æ–¯æ‹‰çš„æ ‡å‡†è¢«å¹¿æ³›é‡‡ç”¨ã€‚",[m
[32m+[m[32m                "ä» 2025 å¹´å¼€å§‹ï¼Œç¦ç‰¹ã€é€šç”¨ã€æœ¬ç”°ç­‰å…¬å¸çš„æ–°è½¦å‹å°†åŒ…å« NACS ç«¯å£ï¼Œä»¥æ¥å…¥ç‰¹æ–¯æ‹‰è¶…çº§å……ç”µç½‘ç»œã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "OEM å……ç”µè”ç›Ÿ:",[m
[32m+[m[32m                "ä¸ƒå®¶ä¸»è¦æ±½è½¦åˆ¶é€ å•†ï¼ˆå®é©¬ã€é€šç”¨ã€æœ¬ç”°ç­‰ï¼‰äº 2023 å¹´æˆç«‹åˆèµ„ä¼ä¸šã€‚",[m
[32m+[m[32m                "è®¡åˆ’åœ¨åŒ—ç¾å®‰è£… 30,000+ ä¸ªå¤§åŠŸç‡å……ç”µæ¡©ï¼ŒåŒæ—¶æ”¯æŒ CCS å’Œ NACS è¿æ¥å™¨ã€‚",[m
[32m+[m[32m                "Plug & Charge (ISO 15118) åŠŸèƒ½æ­£é€æ­¥æ¨å¹¿ï¼Œå®ç°è‡ªåŠ¨è®¤è¯å’Œè®¡è´¹ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "å…¨çƒä¸»è¦æ”¿åºœæ”¿ç­– (2024-2025)",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "ç¾å›½:",[m
[32m+[m[32m                "2024 å¹´åˆä¿®æ”¹æ¸…æ´è½¦è¾†ç¨æ”¶æŠµå…æ”¿ç­–ã€‚",[m
[32m+[m[32m                "å…è®¸åœ¨é”€å”®ç‚¹å³æ—¶è·å¾—æŠ˜æ‰£ï¼ˆæ–°è½¦æœ€é«˜ 7500 ç¾å…ƒï¼‰ã€‚",[m
[32m+[m[32m                "ä½†ç¬¦åˆæ¡ä»¶çš„ EV è½¦å‹å‡å°‘ï¼ˆçº¦ 110 æ¬¾ä¸­çš„ 20 æ¬¾ï¼‰ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "æ¬§æ´²:",[m
[32m+[m[32m                "å¾·å›½ç­‰å¸‚åœºå–æ¶ˆæˆ–å‡å°‘è¡¥è´´å¯¼è‡´ 2024 å¹´é”€é‡åœæ»ã€‚",[m
[32m+[m[32m                "æŒªå¨ç›®æ ‡åœ¨ 2025 å¹´å®ç° 100% é›¶æ’æ”¾æ±½è½¦é”€å”®ã€‚",[m
[32m+[m[32m                "æ¬§ç›Ÿ 2025 å¹´èµ·å®æ–½æ›´ä¸¥æ ¼çš„ CO2 æ’æ”¾æ ‡å‡†ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "ä¸»æµè½¦å‹å¯¹æ¯” (VW ID.4 vs Tesla Model Y)",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "å¤§ä¼— ID.4 Pro (2025):",[m
[32m+[m[32m                "EPA ç»­èˆª: çº¦ 291 è‹±é‡Œã€‚",[m
[32m+[m[32m                "0-60 mph: çº¦ 5.7 ç§’ (AWD)ã€‚",[m
[32m+[m[32m                "æŠ€æœ¯: æ”¯æŒæ— çº¿ Apple CarPlayÂ® å’Œ Android Autoâ„¢ï¼Œä¿ç•™äº†éƒ¨åˆ†ç‰©ç†æŒ‰é”®ã€‚",[m
[32m+[m[32m                "å†…éƒ¨: ç©ºé—´å®½æ•ï¼Œä¹˜åèˆ’é€‚æ€§é«˜ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "ç‰¹æ–¯æ‹‰ Model Y Long Range:",[m
[32m+[m[32m                "EPA ç»­èˆª: çº¦ 310 è‹±é‡Œã€‚",[m
[32m+[m[32m                "0-60 mph: çº¦ 4.6 ç§’ã€‚",[m
[32m+[m[32m                "æŠ€æœ¯: å®Œå…¨ä¾èµ–ä¸­å¤®è§¦æ‘¸å±ï¼Œæ—  CarPlay/Android Autoã€‚",[m
[32m+[m[32m                "å†…éƒ¨: æç®€è®¾è®¡ï¼Œæä¾›ç´§å‡‘çš„ç¬¬ä¸‰æ’åº§ä½é€‰é¡¹ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "è‡ªåŠ¨é©¾é©¶æŠ€æœ¯è·¯å¾„å¯¹æ¯”",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "ç‰¹æ–¯æ‹‰ (Tesla FSD):",[m
[32m+[m[32m                "ä¼ æ„Ÿå™¨: çº¯è§†è§‰ï¼ˆä»… 8 ä¸ªæ‘„åƒå¤´ï¼‰ã€‚",[m
[32m+[m[32m                "åœ°å›¾: ä¸ä¾èµ–é«˜ç²¾åœ°å›¾ï¼ˆHD Mapsï¼‰ï¼Œè®¾è®¡ç”¨äºéšå¤„è¡Œé©¶ã€‚",[m
[32m+[m[32m                "æ¶æ„: ç«¯åˆ°ç«¯ AIï¼Œä¾èµ–å¼ºå¤§çš„æ•°æ®è½¦é˜Ÿå’Œ Dojo è®­ç»ƒã€‚",[m
[32m+[m[32m                "æ¨¡å¼: ADASï¼ˆé«˜çº§é©¾é©¶è¾…åŠ©ï¼‰ï¼Œéœ€é©¾é©¶å‘˜ç›‘æ§ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "Waymo:",[m
[32m+[m[32m                "ä¼ æ„Ÿå™¨: å†—ä½™å †æ ˆï¼ˆ29 ä¸ªæ‘„åƒå¤´ã€6 ä¸ªé›·è¾¾ã€5 ä¸ª LiDARï¼‰ã€‚",[m
[32m+[m[32m                "åœ°å›¾: ä¸¥é‡ä¾èµ–é«˜ç²¾åœ°å›¾ï¼Œä»…åœ¨å·²ç»˜åˆ¶çš„åœ°ç†å›´æ åŒºåŸŸå†…è¿è¡Œã€‚",[m
[32m+[m[32m                "æ¶æ„: å¤šä¸ªç¥ç»ç½‘ç»œåˆ†ç¦»è®­ç»ƒï¼Œå®‰å…¨æ€§æ›´é«˜ã€‚",[m
[32m+[m[32m                "æ¨¡å¼: Robotaxiï¼ˆè‡ªåŠ¨é©¾é©¶å‡ºç§Ÿè½¦ï¼‰ï¼Œæ— éœ€é©¾é©¶å‘˜ä»‹å…¥ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "two_column",[m
[32m+[m[32m            "title": "æ¶ˆè´¹è€…æ¥å—åº¦ä¸ä¸»è¦éšœç¢ (2025)",[m
[32m+[m[32m            "left_content": [[m
[32m+[m[32m                "ä¸»è¦éšœç¢ (å…¨çƒ):",[m
[32m+[m[32m                "æˆæœ¬: 60% çš„æ¶ˆè´¹è€…è®¤ä¸º BEV ä»ç„¶è¿‡äºæ˜‚è´µã€‚",[m
[32m+[m[32m                "å……ç”µæ—¶é—´: 56% çš„æ¶ˆè´¹è€…è®¤ä¸ºæ˜¯ä¸»è¦éšœç¢ã€‚",[m
[32m+[m[32m                "å……ç”µç«™å¯ç”¨æ€§: 54% çš„æ¶ˆè´¹è€…è®¤ä¸ºæ˜¯éšœç¢ï¼ˆç¾å›½ä¸º 44%ï¼‰ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m            "right_content": [[m
[32m+[m[32m                "å¸‚åœºè®¤çŸ¥:",[m
[32m+[m[32m                "å¯¹æˆæœ¬ã€ç»´æŠ¤å’Œç§Ÿèµçš„è¯¯è§£å‡ç¼“äº†é‡‡ç”¨é€Ÿåº¦ã€‚",[m
[32m+[m[32m                "äºŒæ‰‹ EV å¸‚åœºè¿…é€Ÿæ‰©å¤§ï¼Œå—ç§Ÿçº¦åˆ°æœŸå’Œç¨æ”¶æŠµå…æ¨åŠ¨ã€‚",[m
[32m+[m[32m                "è¿‘ 30% çš„æ¶ˆè´¹è€…è¡¨ç¤ºæ„¿æ„ç­‰å¾… 30-60 åˆ†é’Ÿå……ç”µã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m        {[m
[32m+[m[32m            "slide_type": "content",[m
[32m+[m[32m            "title": "å¸‚åœºåé¦ˆä¸å±•æœ› (è‡³ 2030 å¹´)",[m
[32m+[m[32m            "content": [[m
[32m+[m[32m                "å¸‚åœºè§„æ¨¡é¢„æµ‹: å…¨çƒç”µåŠ¨æ±½è½¦å¸‚åœºé¢„è®¡å°†ä» 2024 å¹´çš„ 8964.5 äº¿ç¾å…ƒå¢é•¿åˆ° 2030 å¹´çš„ 2.82 ä¸‡äº¿ç¾å…ƒä»¥ä¸Šã€‚",[m
[32m+[m[32m                "å¢é•¿ç‡ (CAGR): é¢„è®¡ 2025 å¹´è‡³ 2030 å¹´çš„å¤åˆå¹´å¢é•¿ç‡å°†è¶…è¿‡ 21.51%ã€‚",[m
[32m+[m[32m                "å…³é”®é©±åŠ¨åŠ›: æŒç»­çš„æŠ€æœ¯è¿›æ­¥ï¼ˆç‰¹åˆ«æ˜¯ç”µæ± ï¼‰ã€æ”¿åºœæ¿€åŠ±æªæ–½å’Œç¢³æ’æ”¾æ³•è§„ã€ä»¥åŠæ¶ˆè´¹è€…å¯¹å¯æŒç»­äº¤é€šçš„ç¯ä¿æ„è¯†å¢å¼ºã€‚",[m
[32m+[m[32m                "æŠ€æœ¯è¶‹åŠ¿: å›ºæ€ç”µæ± ç­‰æ›¿ä»£æŠ€æœ¯é¢„è®¡å°†è¿›ä¸€æ­¥é™ä½æˆæœ¬å¹¶æé«˜æ€§èƒ½ã€‚",[m
[32m+[m[32m            ],[m
[32m+[m[32m        },[m
[32m+[m[32m    ][m
[32m+[m
[32m+[m[32m    print("æ­£åœ¨ç”Ÿæˆ PPT (Google Q3 è´¢æŠ¥)...")[m
[32m+[m
[32m+[m[32m    # 4. è¿è¡Œå®Œæ•´ç”Ÿæˆæµç¨‹[m
[32m+[m[32m    output_title = "Google_Q3_2025_Report"[m
[32m+[m[32m    result = engine.create_from_template(title=output_title, slides_data=sample_data)[m
[32m+[m
[32m+[m[32m    # 5. ä¿å­˜åˆ°ç£ç›˜[m
[32m+[m[32m    if result and "buffer" in result:[m
[32m+[m[32m        ppt_buffer = result["buffer"][m
[32m+[m[32m        output_filename = f"{output_title}.pptx"[m
[32m+[m
[32m+[m[32m        try:[m
[32m+[m[32m            if hasattr(ppt_buffer, "seek"):[m
[32m+[m[32m                ppt_buffer.seek(0)[m
[32m+[m
[32m+[m[32m            with open(output_filename, "wb") as f:[m
[32m+[m[32m                f.write([m
[32m+[m[32m                    ppt_buffer.getbuffer()[m
[32m+[m[32m                    if hasattr(ppt_buffer, "getbuffer")[m
[32m+[m[32m                    else ppt_buffer.read()[m
[32m+[m[32m                )[m
[32m+[m
[32m+[m[32m            print(f"SUCCESS: æ–‡ä»¶å·²ä¿å­˜è‡³æœ¬åœ° -> {os.path.abspath(output_filename)}")[m
[32m+[m
[32m+[m[32m        except IOError as e:[m
[32m+[m[32m            print(f"ERROR: æ–‡ä»¶å†™å…¥å¤±è´¥: {e}")[m
[32m+[m[32m    else:[m
[32m+[m[32m        print("ERROR: ç”Ÿæˆç»“æœæ— æ•ˆæˆ–ç¼ºå°‘æ–‡ä»¶ç¼“å†²åŒºæ•°æ®")[m
[1mdiff --git a/mvp_fastapi/services/exporter.py b/mvp_fastapi/services/exporter.py[m
[1mindex aa3165b..52ab955 100644[m
[1m--- a/mvp_fastapi/services/exporter.py[m
[1m+++ b/mvp_fastapi/services/exporter.py[m
[36m@@ -1 +1,56 @@[m
[31m-# å¯¼å‡ºæœåŠ¡ï¼Œå°†PPTå¯¹è±¡è½¬æ¢ä¸ºå¯ä¸‹è½½çš„æ–‡ä»¶ç¼“å†²åŒº[m
\ No newline at end of file[m
[32m+[m[32m"""PPTå¯¼å‡ºæœåŠ¡æ¨¡å—ã€‚[m
[32m+[m
[32m+[m[32mè¯¥æ¨¡å—è´Ÿè´£å°†PPTå¯¹è±¡è½¬æ¢ä¸ºå¯ä¸‹è½½çš„PPTXæ–‡ä»¶ç¼“å†²åŒºã€‚[m
[32m+[m[32m"""[m
[32m+[m
[32m+[m[32mimport io[m
[32m+[m[32mfrom typing import Dict, Any, Optional[m
[32m+[m[32mfrom pptx import Presentation[m
[32m+[m
[32m+[m
[32m+[m[32mclass PPTExporter:[m
[32m+[m[32m    """PPTå¯¼å‡ºå™¨ç±»ï¼Œè´Ÿè´£å°†PPTå¯¹è±¡è½¬æ¢ä¸ºPPTXæ–‡ä»¶ç¼“å†²åŒºã€‚"""[m
[32m+[m
[32m+[m[32m    def __init__(self):[m
[32m+[m[32m        """åˆå§‹åŒ–å¯¼å‡ºå™¨ã€‚"""[m
[32m+[m[32m        self.supported_formats = ["pptx"][m
[32m+[m[32m        self.default_format = "pptx"[m
[32m+[m
[32m+[m[32m    def export_ppt([m
[32m+[m[32m        self, presentation: Presentation, title: Optional[str] = None[m
[32m+[m[32m    ) -> Dict[str, Any]:[m
[32m+[m[32m        """å¯¼å‡ºPPTä¸ºPPTXæ ¼å¼ã€‚[m
[32m+[m
[32m+[m[32m        Args:[m
[32m+[m[32m            presentation: PPTå¯¹è±¡[m
[32m+[m[32m            title: PPTæ ‡é¢˜ï¼Œç”¨äºç”Ÿæˆæ–‡ä»¶å[m
[32m+[m
[32m+[m[32m        Returns:[m
[32m+[m[32m            åŒ…å«PPTXæ–‡ä»¶ç¼“å†²åŒºå’Œå…ƒæ•°æ®çš„å­—å…¸[m
[32m+[m[32m        """[m
[32m+[m[32m        buffer = io.BytesIO()[m
[32m+[m[32m        presentation.save(buffer)[m
[32m+[m[32m        buffer.seek(0)[m
[32m+[m
[32m+[m[32m        return {[m
[32m+[m[32m            "buffer": buffer,[m
[32m+[m[32m            "content_type": "application/vnd.openxmlformats-officedocument.presentationml.presentation",[m
[32m+[m[32m            "filename": self._generate_filename(title),[m
[32m+[m[32m            "file_size": len(buffer.getvalue()),[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    def _generate_filename(self, title: Optional[str] = None) -> str:[m
[32m+[m[32m        """ç”Ÿæˆå¯¼å‡ºæ–‡ä»¶åã€‚[m
[32m+[m
[32m+[m[32m        Args:[m
[32m+[m[32m            title: PPTæ ‡é¢˜[m
[32m+[m
[32m+[m[32m        Returns:[m
[32m+[m[32m            ç”Ÿæˆçš„æ–‡ä»¶å[m
[32m+[m[32m        """[m
[32m+[m[32m        base_name = title.replace(" ", "_") if title else "presentation"[m
[32m+[m[32m        return f"{base_name}.pptx"[m
[32m+[m
[32m+[m
[32m+[m[32m# å¯¼å‡ºæœåŠ¡å®ä¾‹[m
[32m+[m[32mexporter_service = PPTExporter()[m
[1mdiff --git a/mvp_fastapi/services/outline.py b/mvp_fastapi/services/outline.py[m
[1mindex a14bcc2..9384047 100644[m
[1m--- a/mvp_fastapi/services/outline.py[m
[1m+++ b/mvp_fastapi/services/outline.py[m
[36m@@ -1 +1 @@[m
[31m-# å¤§çº²ç”ŸæˆæœåŠ¡ï¼Œæ ¹æ®ç”¨æˆ·æç¤ºç”ŸæˆPPTå¤§çº²ç»“æ„[m
\ No newline at end of file[m
[32m+[m[32m# å¤§çº²ç”ŸæˆæœåŠ¡ï¼Œæ ¹æ®ç”¨æˆ·æç¤ºç”ŸæˆPPTå¤§çº²ç»“æ„[m
